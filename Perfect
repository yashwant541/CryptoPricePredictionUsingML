import pandas as pd

def add_row_number_column(file_path, sheet_name):
    # Load the Excel file
    xls = pd.ExcelFile(file_path)
    
    # Check if the sheet exists in the file
    if sheet_name not in xls.sheet_names:
        print(f"Sheet '{sheet_name}' not found in the Excel file.")
        return

    # Read the specific sheet into a DataFrame
    df = pd.read_excel(file_path, sheet_name=sheet_name)

    # Initialize the Row Number column
    df['Row Number'] = 1

    # Iterate over the DataFrame to update the Row Number column
    for i in range(1, len(df)):
        if df.loc[i, 'ColumnA'] != df.loc[i - 1, 'ColumnA']:
            df.loc[i, 'Row Number'] = df.loc[i - 1, 'Row Number'] + 1
        else:
            df.loc[i, 'Row Number'] = df.loc[i - 1, 'Row Number']

    # Save the DataFrame back to the Excel file
    with pd.ExcelWriter(file_path, engine='openpyxl', mode='a', if_sheet_exists='replace') as writer:
        df.to_excel(writer, sheet_name=sheet_name, index=False)

    print(f"Row Number column added and saved to '{sheet_name}' sheet in the file '{file_path}'.")

# Prompt the user for the file path and sheet name
file_path = input("Enter the path to the Excel file: ")
sheet_name = input("Enter the sheet name: ")

add_row_number_column(file_path, sheet_name)
