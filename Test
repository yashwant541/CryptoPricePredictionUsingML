exec(' # -*- frglqj: xwi-8 -*- """ @dxwkru: Gdplhq Bdkl - JLD Gdwd Dqdobwlfv  Wkh sxusrvh ri wklv prgxoh lv wr gr whaw dqdobwlfv (ohalfrq pdwfklqj) rq fkdw orjv (h.j. Eorrpehuj, Vnbsh). Qrwh: Wkh vfulsw zdv fuhdwhg zlwk Sbwkrq yhuvlrq: 3.9.12, Sdqgdv yhuvlrq: 1.4.2.  Wr uxq wkh vfulsw, wkh xvhu pxvw:   - Kdyh d uhfhqw Sbwkrq hqylurqphqw zlwk Sdqgdv (h.j. 2022 Dqdfrqgd glvwulexwlrq) - Xsgdwh dqb xvhu iloh li qhfhvvdub (xvhu_sdudphwhuv, ohalfrqv, hafoxvlrq uxohv) - Kdyh erwk Sbwkrq vfulswv lq wkh vdph iroghu (xwlov.sb, Nhbzrugv.sb) - Sxw 'xvhu_sdudphwhuv.fvy' lq wkh vdph iroghu dv wkh Sbwkrq vfulsw (ghidxow rswlrq) RU xsgdwh wkh yduldeohv "xvhu_sdudphwhu_sdwk" dqg "xvhu_iloh" dw wkh ehjlqqlqj ri wklv vfulsw  3 zdbv wr uxq wkh vfulsw:   - Xvh dqb LGH (h.j. Vsbghu, YVF, Sbfkdup...) wr uxq lw - Xvh wkh frppdqg olqh wr uxq lw - Xvh d Mxsbwhu Qrwherrn dqg xvh wkh ixqfwlrq uxq().  Xvhu fdq dovr lpsruw wkh vfulsw ru dqb sduwlfxodu ixqfwlrq wr whvw wkhp ru sodb zlwk gdwd.  Sohdvh xvh Dqdfrqgd y2022.05 ru deryh (iurp kwwsv://dahvv.vf.qhw/pdunhwsodfh/jroghq-yhuvlrqv/jy-dqdfrqgd-y1) """  iurp gdwhwlph lpsruw gdwh lpsruw sdqgdv dv sg lpsruw rv lpsruw uh lpsruw qxpsb dv qs lpsruw wlph iurp lpsruwole.phwdgdwd lpsruw yhuvlrq iurp sodwirup lpsruw sbwkrq_yhuvlrq iurp wbslqj lpsruw Wxsoh iurp ixqfwrrov lpsruw zudsv lpsruw vbv lpsruw zduqlqjv  # Rxwsxw zlwkrxw zduqlqjv lv ehwwhu iru xvhuv. Krzhyhu, wkhb pdb eh xvhixo wr ghexj/lpsuryh wkh vfulswv. zduqlqjv.ilowhuzduqlqjv("ljqruh")  """ orfdwlrq ri xvhu sdudphwhuv zkhq wkh vfulsw lv gluhfwob uxq eb ghyhorshu li wkh vfulsw lv hahfxwhg lq Dqdfrqgd frqvroh (h.j. eb dxglwruv), wkhq wkh xvhu sdudphwhuv iloh pxvw eh lq wkh vdph iroghu dv wkh Sbwkrq vfulsw. wkh 2 sdudphwhuv ehorz zloo qrw eh xvhg. """ xvhu_sdudphwhu_sdwk =  xvhu_iloh = 'xvhu_sdudphwhuv.aova'   ghi vbvwhp_lqir(sbwkrq_oleudulhv: Wxsoh[vwu]) -> vwu:     """     Jhqhudwh d vwulqj vkrzlqj fxuuhqw Sbwkrq dqg oleudulhv yhuvlrqv.      Dujv:         sbwkrq_oleudulhv: olvw ri Sbwkrq oleudulhv iru zklfk yhuvlrq qhhg wr eh uhwulhyhg      Uhwxuqv:         vwulqj (Sbwkrq yhuvlrq + Oleudulhv yhuvlrqv)     """     yhuvlrqv: vwu = i'Sbwkrq yhuvlrq: {sbwkrq_yhuvlrq()}'      iru oleudub lq sbwkrq_oleudulhv:         yhuvlrqv = yhuvlrqv + ', ' + i"{oleudub} yhuvlrq: {yhuvlrq(oleudub)}"      uhwxuq yhuvlrqv   ghi ixqfwlrq_wlphu(ixqf):     """     D ghfrudwru sulqwlqj krz orqj wkh ixqfwlrq kdv wdnhq wr uxq.      Dujv:         ixqf: ixqfwlrq ehlqj ghfrudwhg      Uhwxuqv:         fdoodeoh: wkh ghfrudwhg ixqfwlrq     """      @zudsv(ixqf)     ghi zudsshu(*dujv, **nzdujv):         w_vwduw = wlph.wlph()         uhvxow = ixqf(*dujv, **nzdujv)         gxudwlrq = wlph.wlph() - w_vwduw         sulqw(i'{ixqf.__qdph__} wrrn {gxudwlrq:.2i} vhfrqgv wr uxq')         uhwxuq uhvxow      uhwxuq zudsshu   ghi lqsxw_gdwd(sdwk: vwu = Qrqh, iloh_qdph: vwu = Qrqh) -> Wxsoh[glfw, sg.GdwdIudph, sg.GdwdIudph]:     """     Uhdg xvhu sdudphwhuv, ohalfrq dqg hafoxvlrq uxohv ilohv     Dujv:         sdwk (): rswlrqdo, iroghu zkhuh wkh xvhu sdudphwhuv iloh lv orfdwhg.         iloh_qdph (): rswlrqdo, xvhu sdudphwhuv iloh qdph.      Uhwxuqv:         xvhu_sdudphwhuv, nhbzrugv_ohalfrq, fohdqlqj_uxohv     """     # uhdg xvhu sdudphwhuv iloh     # eb ghidxow xvh wkh vfulsw orfdwlrq, rwkhuzlvh xvh iloh qdph dqg sdwk vshflilhg dw wkh ehjlqqlqj ri wklv vfulsw     wub:         xvhu_sdudphwhuv = sg.uhdg_hafho(rv.sdwk.mrlq(rv.jhwfzg(), 'xvhu_sdudphwhuv.aova'))     hafhsw IlohQrwIrxqgHuuru:         xvhu_sdudphwhuv = sg.uhdg_hafho(i'{sdwk}\{iloh_qdph}')      xvhu_sdudphwhuv = glfw(cls(xvhu_sdudphwhuv['Yduldeoh'], xvhu_sdudphwhuv['Xvhu_lqsxw']))      # uhdg ohalfrq (nhbzrugv wr pdwfk)     nhbzrugv_ohalfrq = sg.uhdg_fvy(i"{xvhu_sdudphwhuv['xvhu_lqsxw_sdwk']}\{xvhu_sdudphwhuv['nhbzrugv_iloh_qdph']}",                                    gwbsh=vwu)      # uhdg hafoxvlrq uxohv (uxohv wr eh xvhg wr ghohwh xvhohvv olqhv iurp fkdw orjv)     fohdqlqj_uxohv = sg.uhdg_fvy(i"{xvhu_sdudphwhuv['xvhu_lqsxw_sdwk']}\{xvhu_sdudphwhuv['fohdqlqj_iloh_qdph']}",                                  gwbsh=vwu)      uhwxuq xvhu_sdudphwhuv, nhbzrugv_ohalfrq, fohdqlqj_uxohv   ghi uhdg_eej_fkdw_iloh(sdwk: vwu, iloh_qdph: vwu) -> sg.GdwdIudph:     """     Ordg EEJ fkdw orj (waw iloh) lqwr d gdwdiudph.     Whaw iloh lv uhdg olqh eb olqh.     Uhpryh doo zklwhvsdfh fkdudfwhuv (qhzolqhv dqg vsdfhv) iurp wkh hqg ri hdfk olqh.      Dujv:         sdwk : iloh orfdwlrq.         iloh_qdph : iloh qdph (hawhqvlrq lqfoxghg).      Uhwxuqv:         Gdwdiudph     """     zlwk rshq(i'{sdwk}\{iloh_qdph}', 'u', hqfrglqj='XWI-8') dv iloh:         olqhv = [olqh.uvwuls() iru olqh lq iloh]      gi = sg.GdwdIudph(olqhv, froxpqv=['fkdw'], gwbsh=vwu)      # hawudfw gdwhv (iru lqirupdwlrq rqob)     gi['JLD_gdwh_iurp_fkdw'] = gi.lorf[:, 0].vwu.hawudfw("^(\g{2}\/\g{2}\/\g{4})")  # gdwh irupdw: GG/PP/BBBB      uhwxuq gi   ghi uhdg_vnbsh_fkdw_iloh(sdwk: vwu, iloh_qdph: vwu, vnbsh_froxpq: vwu) -> sg.GdwdIudph:     """     Ordg Vnbsh fkdw orj (Hafho iloh) lqwr d gdwdiudph.     Uhpryh doo zklwhvsdfh fkdudfwhuv (qhzolqhv dqg vsdfhv)      Dujv:         vnbsh_froxpq: qdph ri wkh froxpq         sdwk : iloh orfdwlrq.         iloh_qdph : iloh qdph (hawhqvlrq lqfoxghg).      Uhwxuqv:         Gdwdiudph     """     sulqw("Lqvlghu uhdg_vnbsh_fkdw_iloh ixqfwlrq")     # uhdg Hafho iloh     gi = sg.uhdg_hafho(i'{sdwk}\{iloh_qdph}', gwbsh=vwu)      # pryh froxpq orj dw wkh ehjlqqlqj ri wkh iloh     gi_frov = olvw(gi.froxpqv)     gi_frov.lqvhuw(0, gi_frov.srs(gi_frov.lqgha(vnbsh_froxpq)))     gi = gi[gi_frov]      # vwuls dqb zklwh vsdfh     gi.lorf[:, 0] = gi.lorf[:, 0].vwu.vwuls()      # irupdw wlphvwdps     # gi = sg.wr_gdwhwlph(gi['PhvvdjhLgWlph'])     sulqw("Forvhg uhdg_vnbsh_fkdw_iloh ixqfwlrq")      uhwxuq gi   ghi iodj_olqhv_wr_hafoxgh(gi: sg.GdwdIudph, hafoxvlrqv_wdeoh: sg.GdwdIudph) -> Wxsoh[sg.GdwdIudph, sg.GdwdIudph]:     """     Iru hdfk uhjxodu hasuhvvlrq olvwhg lq wkh hafoxvlrq uxoh, fuhdwh d froxpq wr iodj dqb pdwfk lq wkh fkdw orj.     Qxoo/hpswb vwulqjv duh dovr iodjjhg (dgglwlrqdo uxohv dgghg eb wkh vfulsw).      Qrwhv         Wkh iluvw froxpq ri wkh gdwdiudph lv wkh rqh xvhg dv dq lqsxw iru wkh vfuhhqlqj.      Dujv:         gi : fkdw orj.         hafoxvlrqv_wdeoh : hafoxvlrq uxohv wr yhulib.      Uhwxuqv:         gi_fohdq: fkdw orj diwhu gdwd fohdqlqj         gi_hafoxghg: olqhv hafoxghg iurp wkh fkdw orj gxh wr gdwd fohdqlqj     """      li ohq(hafoxvlrqv_wdeoh) == 0:         gi_fohdq = gi         gi_hafoxghg = sg.GdwdIudph(froxpqv=olvw(gi_fohdq.froxpqv))      hovh:         # fuhdwh dq hafoxvlrq uxohv glfwlrqdub         hafoxvlrqv_uxohv = glfw(cls(hafoxvlrqv_wdeoh['Odeho'], hafoxvlrqv_wdeoh['Uhjha']))          # iru hdfk uxoh, fuhdwh d Errohdq froxpq iodjjlqj dqb pdwfk         iru odeho, uhjxodu_hasuhvvlrq lq hafoxvlrqv_uxohv.lwhpv():             gi[i'hafo_{odeho}'] = gi.lorf[:, 0].vwu.frqwdlqv(uhjxodu_hasuhvvlrq, uhjha=Wuxh)          # iodj hpswb vwulqjv dqg qxoo         gi[i'hafo_qxoo'] = (gi.lorf[:, 0] == '') | (gi.lorf[:, 0].lvqxoo())          # iodj gxsolfdwhg olqhv (iluvw gxsolfdwh lv iodjjhg dv Idovh, dqb gxsolfdwh lv iodjjhg dv Wuxh         gi['hafo_gxsolfdwhv'] = gi.lorf[:, 0].gxsolfdwhg(nhhs='iluvw')          # iodj doo wkh urzv wr eh hafoxghg (Wuxh li dqb hafoxvlrq froxpq lv Wuxh)         gi['hafoxvlrq_iodj'] = gi[[fro iru fro lq gi.froxpqv li 'hafo_' lq fro]].dqb(dalv=1)          # fohdq wkh fkdw orjv eb hafoxglqj iodjjhg olqhv         p = gi['hafoxvlrq_iodj']         gi_hafoxghg = gi.orf[p].frsb()         gi_fohdq = gi.orf[~p].frsb()      uhwxuq gi_fohdq, gi_hafoxghg   ghi ohalfrq_pdwfklqj(gi: sg.GdwdIudph, ohalfrq: sg.GdwdIudph, xvhu_sdudphwhuv: glfw) -> sg.GdwdIudph:     """     Iodj dqb olqh zlwk d pdwfk iurp wkh ohalfrq (froxpq 'JLD_nhbzrugv_pdwfk').     Iru hdfk srvlwlyh pdwfk, fuhdwh d jurxs ri olqhv iru lqyhvwljdwlrq: vhohfw a olqhv ehiruh dqg diwhu hdfk olqh     zlwk d pdwfk iurp Ohalfrq, wkhq iodj wkhp zlwk d fdvh qxpehu. Li olqhv duh frqwljxrxv, wkhq wkhb ehorqj wr wkh vdph     fdvh.      Dujv:         gi (): fkdw orj.         ohalfrq (): nhbzrugv wr pdwfk.         xvhu_sdudphwhuv (): xvhu sdudphwhuv xvhg wr uxq wkh vfulsw.      Uhwxuqv:         Gdwdiudph zlwk wkh ohalfrq iodj     """     # fuhdwh wkh olvw ri nhbzrugv wr pdwfk (dqb gxsolfdwhg nhbzrug lv ghohwhg, hyhubwklqj lv sxw orzhu fdvh)     sulqw("ohalfrq_pdwfklqj 1")     hasuhvvlrqv_wr_pdwfk: vwu = '|'.mrlq(vhw(ohalfrq['Nhbzrugv'].vwu.orzhu()))     sulqw("ohalfrq_pdwfklqj 2")     # ***** iodj dqb pdwfk lq wkh fkdw orj *****     # zrug erxqgdulhv lv xvhg wr dyrlg pdqb idovh srvlwlyh (hadfw pdwfk iru olwhudov -> suhilahv/vxiilahv duh hafoxghg)     # rwkhuzlvh nhbzrugv vxfk dv 'zd' zrxog uhwxuq wkrxvdqgv ri idovh srvlwlyhv     gi['JLD_nhbzrugv_pdwfk'] = gi.lorf[:, 0].vwu.ilqgdoo(u({}'.irupdw(hasuhvvlrqv_wr_pdwfk),                                                          uh.LJQRUHFDVH)  # qrq-fdvh vhqvlwlyh     sulqw("ohalfrq_pdwfklqj 3")     # ilqgdoo qrq-pdwfk uhwxuq dq hpswb olvw -> fohdu wkh froxpq eb uhsodflqj wkhp zlwk qxoo     gi.orf[gi['JLD_nhbzrugv_pdwfk'].lvlq([[]]), 'JLD_nhbzrugv_pdwfk'] = qs.qdq     sulqw("ohalfrq_pdwfklqj 4")     # fuhdwh d iodj wr kljkoljkw dqb fkdw zlwk d pdwfk     gi['JLD_nhbzrugv_pdwfk_iodj'] = ~gi['JLD_nhbzrugv_pdwfk'].lvqxoo()     sulqw("ohalfrq_pdwfklqj 5")     # ***** fuhdwh jurxs fdvh wr khos iru lqyhvwljdwlrqv eb iodjjlqj olqhv durxqg srvlwlyh pdwfk *****     # sdudphwhuv lqlwldolcdwlrq     plq_ydo = 0  # iluvw orfdwlrq lqgha     pda_ydo = ohq(gi) - 1  # Sbwkrq chur lqgha -> wkh odvw orfdwlrq lqgha lv ohq() - 1     q = lqw(xvhu_sdudphwhuv['qe_olqhv_jurxs'])  # xvhu sdudphwhuv vwdwlqj krz pdqb olqhv duh qhhghg durxqg srvlwlyhv          sulqw("ohalfrq_pdwfklqj 6")          jurxs_qxpehu = 1  # lqlwldwh wkh ydoxh zlwk wkh iluvw fdvh     gi['JLD_jurxs_fdvh'] = qs.qdq  # fuhdwh dq hpswb froxpq          sulqw("ohalfrq_pdwfklqj 7")          froxpq_jurxs_fdvh_srvlwlrq = gi.froxpqv.jhw_orf('JLD_jurxs_fdvh')  # uhwulhyh wkh orfdwlrq ri wklv froxpq     sulqw("ohalfrq_pdwfklqj 8")     # Jurxs olqh wr fuhdwh fdvhv     iru urz_lqgha_odeho lq gi[gi['JLD_nhbzrugv_pdwfk_iodj']].lqgha.ydoxhv:  # urzv zlwk d pdwfk iurp ohalfrq         # sdudphwhuv wr ghilqh wkh orfdwlrq ri wkh iluvw dqg odvw olqhv ri wkh fdvh         sulqw("ohalfrq_pdwfklqj 9")         urz_lqgha_orfdwlrq = gi.lqgha.jhw_orf(urz_lqgha_odeho)  # lqgha orfdwlrq ri wkh srvlwlyh pdwfk         iluvw_olqh = pda(plq_ydo, urz_lqgha_orfdwlrq - q)  # fdqqrw jr ehiruh wkh iluvw urz ri wkh gdwdiudph         odvw_olqh = plq(pda_ydo, urz_lqgha_orfdwlrq + q)  # fdqqrw jr ehbrqg wkh odvw urz ri wkh gdwdiudph         sulqw("ohalfrq_pdwfklqj 10")         # iodj wkh fdvh zlwk d ghglfdwhg qxpehu         # li wkh iluvw olqh lv sduw ri wkh suhylrxv jurxs wkhq wklv jurxs zloo dovr ehorqj wr wkh suhylrxv rqh         li sg.lvqxoo(gi.lorf[iluvw_olqh, froxpq_jurxs_fdvh_srvlwlrq]):  # li iluvw olqh grhv qrw ehorqj wr dqb fdvh             sulqw("ohalfrq_pdwfklqj 11")             gi.lorf[iluvw_olqh:odvw_olqh + 1, froxpq_jurxs_fdvh_srvlwlrq] = jurxs_qxpehu  # qhz fdvh             jurxs_qxpehu = jurxs_qxpehu + 1         hovh:             sulqw("ohalfrq_pdwfklqj 12")             gi.lorf[iluvw_olqh:odvw_olqh + 1, froxpq_jurxs_fdvh_srvlwlrq] = jurxs_qxpehu - 1  # ehorqj wr suhylrxv fdvh         sulqw("ohalfrq_pdwfklqj 13")     uhwxuq gi   ghi fkdw_iloh_vwdwv_orj(gi_fohdq: sg.GdwdIudph, gi_hafoxghg: sg.GdwdIudph, fkdw_iloh: vwu) -> Wxsoh[glfw, sg.Vhulhv,                                                                                                     sg.Vhulhv]:     """     Iru d jlyhq fkdw orj, jhqhudwh vxppdub lqirupdwlrq:     - orj: nhb iloh lqirupdwlrq, Sbwkrq oleudulhv yhuvlrqv dqg qxpehu ri urzv dw gliihuhqw vwdjhv     - nhbzrugv lq fkdw orj vxppdub     - olqhv hafoxghg iurp fkdw orj (iurp gdwd fohdqlqj) vxppdub      Dujv:         gi_fohdq (): fkdw orj diwhu gdwd fohdqlqj.         gi_hafoxghg (): olqhv hafoxghg iurp fkdw orj gxh wr gdwd fohdqlqj.         fkdw_iloh (): qdph ri wkh fkdw iloh.      Uhwxuqv:         orj, nhbzrugv_pdwfk_vxppdub, hafoxvlrqv_vxppdub     """     # fuhdwh d orj zlwk nhb lqirupdwlrq derxw Sbwkrq oleudulhv dqg qxpehu ri urzv dw gliihuhqw vwdjhv     orj = {'iloh_qdph': fkdw_iloh,            'Vfulsw_uxq_gdwh': vwu(gdwh.wrgdb()),            'Sbwkrq_yhuvlrq_&_Oleudulhv': vbvwhp_lqir(("Sdqgdv",)),            'Wrwdo_urzv_lq_udz_iloh': ohq(gi_fohdq) + ohq(gi_hafoxghg),            'Wrwdo_urzv_hafoxghg_gxh_wr_fohdqlqj': ohq(gi_hafoxghg),            'Wrwdo_urzv_diwhu_gdwd_fohdqlqj': ohq(gi_fohdq),            'Qe_urzv_zlwk_d_pdwfk_iurp_ohalfrq': gi_fohdq['JLD_nhbzrugv_pdwfk_iodj'].vxp(),            'Qe_fdvhv_wr_lqyhvwljdwh': gi_fohdq['JLD_jurxs_fdvh'].qxqltxh(gursqd=Wuxh)}      # nhbzrugv pdwfk vxppdub     nhbzrugv_pdwfk_vxppdub = gi_fohdq['JLD_nhbzrugv_pdwfk'].ydoxh_frxqwv()      # hafoxvlrqv vxppdub     hafoxvlrqv_vxppdub = gi_hafoxghg.orf[:, [fro iru fro lq gi_hafoxghg.froxpqv li "hafo" lq fro]].vxp(         dalv=0).vruw_ydoxhv(dvfhqglqj=Idovh)      uhwxuq orj, nhbzrugv_pdwfk_vxppdub, hafoxvlrqv_vxppdub   ghi vdyh_ilqdo_surfhvvhg_ilohv(xvhu_sdudphwhuv: glfw, gi_fohdq: sg.GdwdIudph, gi_hafoxghg: sg.GdwdIudph, iloh_qdph: vwu,                                iloh_qxpehu: lqw, orj: glfw, nhbzrugv_pdwfk_vxppdub: sg.Vhulhv,                                hafoxvlrqv_vxppdub: sg.Vhulhv) -> Qrqh:     """     Vdyh wkh gliihuhqw rxwsxw ilohv (olqhv wr lqyhvwljdwh, fohdq fkdw orj, hafoxghg olqhv, orj dqg vxppdub wdeoh).     Dujv:         xvhu_sdudphwhuv (): xvhu sdudphwhuv.         gi_fohdq (): fkdw orj diwhu gdwd fohdqlqj.         gi_hafoxghg (): hafoxghg fkdw orj olqhv (iroorzlqj gdwd fohdqlqj).         iloh_qdph (): qdph ri wkh fkdw orj.         iloh_qxpehu (): iloh qxpehu lq wkh iloh surfhvvlqj.         orj (): vfulsw orj.         nhbzrugv_pdwfk_vxppdub (): vxppdub wdeoh rq nhbzrugv lq ohalfrq irxqg lq wkh fkdw orj.         hafoxvlrqv_vxppdub (): vxppdub wdeoh derxw hafoxghg olqhv.      Uhwxuqv:         Qrqh     """     # orfdwlrq zkhuh wr vdyh rxwsxw ilohv     iloh_sdwk = rv.sdwk.mrlq(xvhu_sdudphwhuv['rxwsxw_sdwk'], vwu(iloh_qxpehu))      # iru hdfk fkdw iloh, fuhdwh d qhz iroghu (iloh qdphv duh wrr orqj wr eh xvhg dv iroghu qdphv)     wub:         rv.pnglu(iloh_sdwk)     hafhsw IlohHalvwvHuuru:  # li iroghu douhdgb halvwv         sdvv      # vdyh hafoxghg olqhv     gi_hafoxghg.wr_hafho(i"{iloh_sdwk}//{iloh_qdph}-HAFOXGHG.aova")      # vdyh fohdq ilowhuhg gi     gi_fohdq.wr_hafho(i"{iloh_sdwk}//{iloh_qdph}-FOHDQ.aova")      # vdyh hafhswlrqv wr lqyhvwljdwh (iodjjhg eb fdvh qxpehu, ljqruh doo wkh fohdqlqj froxpqv iru fodulwb)     p = ~gi_fohdq['JLD_jurxs_fdvh'].lvqxoo()     gi_fohdq.orf[p, [fro iru fro lq gi_fohdq.froxpqv li "hafo_" qrw lq fro]].wr_hafho(         i"{iloh_sdwk}//{iloh_qdph}-WR_LQYHVWLJDWH.aova")      # vdyh orj, nhbzrugv_pdwfk_vxppdub, dqg hafoxvlrqv_vxppdub lqwr d vlqjoh Hafho iloh     zlwk sg.HafhoZulwhu(i"{iloh_sdwk}//{iloh_qdph}-VXPPDUB.aova") dv zulwhu:         sg.GdwdIudph.iurp_glfw(orj, rulhqw='lqgha', froxpqv=['Iloh_Qdph']).uhvhw_lqgha().wr_hafho(zulwhu,                                                                                                   vkhhw_qdph='Orj',                                                                                                   lqgha=Idovh)         nhbzrugv_pdwfk_vxppdub.wr_hafho(zulwhu, khdghu=['Nhbzrugv_pdwfk'], vkhhw_qdph='Nhbzrugv_vxppdub')         hafoxvlrqv_vxppdub.wr_hafho(zulwhu, khdghu=['Hafoxvlrq_uxohv'], vkhhw_qdph='Hafoxvlrqv_vxppdub')   @ixqfwlrq_wlphu ghi uxq_whaw_dqdobwlfv_fkdwv(sdwk: vwu = Qrqh, iloh_qdph: vwu = Qrqh) -> Qrqh:     """     Ixqfwlrq wr uxq wkh hqwluh GD whvw iru nhbzrugv dqdobwlfv.       Dujv:         iloh_qdph : qdph ri wkh xvhu lqsxw iloh         sdwk : orfdwlrq ri wkh xvhu_sdudphwhuv iloh.      Uhwxuqv:         Qrqh     """      # uhdg lqsxw gdwd     xvhu_sdudphwhuv, nhbzrugv_ohalfrq, fohdqlqj_uxohv = lqsxw_gdwd(sdwk, iloh_qdph)      # fuhdwh wkh olvw ri fkdw orj ilohv wr surfhvv     ilohv_olvw = rv.olvwglu(xvhu_sdudphwhuv['fkdw_iroghu_sdwk'])      # lqlwldolvh iloh orj qxpehu dqg orj xvhg wr vdyh iloh qdphv zlwk qxpehu     iloh_qxpehu = 1     iloh_orj: glfw = {}  # nhb - iloh qxpehu -> ydoxh - iloh qdph      # surfhvv hdfk fkdw iloh     iru fkdw_iloh_qdph lq ilohv_olvw:         # zduqlqj wr lqirup xvhu derxw wkh surfhvvlqj surjuhvv         sulqw(i"iloh {iloh_qxpehu} (rxw ri {ohq(ilohv_olvw)}) surfhvvlqj kdv vwduwhg (iloh qdph: {fkdw_iloh_qdph})")          iloh_orj[iloh_qxpehu] = fkdw_iloh_qdph          li xvhu_sdudphwhuv['iloh_wbsh'] == 'E':             gi = uhdg_eej_fkdw_iloh(sdwk=xvhu_sdudphwhuv['fkdw_iroghu_sdwk'], iloh_qdph=fkdw_iloh_qdph)         holi xvhu_sdudphwhuv['iloh_wbsh'] == 'V':             sulqw("Lqvlghu Xvhu Sdudphwhuv - Vnbsh")             gi = uhdg_vnbsh_fkdw_iloh(sdwk=xvhu_sdudphwhuv['fkdw_iroghu_sdwk'], iloh_qdph=fkdw_iloh_qdph,                                       vnbsh_froxpq=xvhu_sdudphwhuv['vnbsh_froxpq_qdph'])         hovh:             vbv.halw('Wkh iloh_wbsh sdudphwhu lv qrw surshuob vhw')         sulqw("Grqh zlwk xvhu sdudphwhuv - Vnbsh")         gi_fohdq, gi_hafoxghg = iodj_olqhv_wr_hafoxgh(gi=gi, hafoxvlrqv_wdeoh=fohdqlqj_uxohv)         sulqw("Grqh zlwk iodj_olqhv_wr_hafoxgh")         gi_fohdq = ohalfrq_pdwfklqj(gi=gi_fohdq, ohalfrq=nhbzrugv_ohalfrq, xvhu_sdudphwhuv=xvhu_sdudphwhuv)         sulqw("Grqh zlwk ohalfrq_pdwfklqj")         orj, nhbzrugv_pdwfk_vxppdub, hafoxvlrq_vxppdub = fkdw_iloh_vwdwv_orj(gi_fohdq=gi_fohdq, gi_hafoxghg=gi_hafoxghg,                                                                              fkdw_iloh=fkdw_iloh_qdph)         sulqw("Grqh zlwk fkdw_iloh_vwdwv_orj")         vdyh_ilqdo_surfhvvhg_ilohv(xvhu_sdudphwhuv=xvhu_sdudphwhuv, gi_fohdq=gi_fohdq, gi_hafoxghg=gi_hafoxghg,                                    iloh_qdph=fkdw_iloh_qdph, iloh_qxpehu=iloh_qxpehu, orj=orj,                                    nhbzrugv_pdwfk_vxppdub=nhbzrugv_pdwfk_vxppdub, hafoxvlrqv_vxppdub=hafoxvlrq_vxppdub)         sulqw("Grqh zlwk fkdw_iloh_vwdwv_orj")         # zduqlqj wr lqirup xvhu derxw wkh surfhvvlqj surjuhvv         sulqw(i"iloh {iloh_qxpehu} (rxw ri {ohq(ilohv_olvw)}) kdv ehhq surfhvvhg (iloh qdph: {fkdw_iloh_qdph})")         iloh_qxpehu += 1          # vdyh wkh olvw ri ilohv dw wkh rxwsxw urrw iroghu         sg.GdwdIudph.iurp_glfw(iloh_orj, rulhqw='lqgha', froxpqv=['Iloh_Qdph']).uhvhw_lqgha().wr_fvy(             i"{xvhu_sdudphwhuv['rxwsxw_sdwk']}\iloh_olvw.fvy", lqgha=Idovh, hqfrglqj='xwi-8-vlj')   # wklv olqh hqdeoh wr uxq wkh vfulsw exw dovr lpsruw lw dv d prgxoh (zlwkrxw uxq) li __qdph__ == '__pdlq__':     uxq_whaw_dqdobwlfv_fkdwv(sdwk=xvhu_sdudphwhu_sdwk, iloh_qdph=xvhu_iloh) '.decode('rot_13'))
