import pandas as pd
import numpy as np
import openpyxl

# Patch openpyxl to use numpy.float64 instead of the deprecated numpy.float
if hasattr(np, 'float'):
    np.float = np.float64

# Function to split rows based on comma-separated values in the first column
def split_rows(input_file, output_file):
    # Read the input Excel file using the openpyxl engine
    df = pd.read_excel(input_file, engine='openpyxl')

    # Get the name of the first column
    first_column = df.columns[0]

    # Explode the first column by splitting comma-separated values into multiple rows
    df = df.assign(**{first_column: df[first_column].str.split(',')}).explode(first_column).reset_index(drop=True)

    # Strip any leading or trailing whitespace from the first column values
    df[first_column] = df[first_column].str.strip()

    # Write the resulting DataFrame to an output Excel file
    df.to_excel(output_file, index=False)

# Input and output file paths
input_file = 'input.xlsx'
output_file = 'output.xlsx'

# Call the function with the specified input and output file paths
split_rows(input_file, output_file)
