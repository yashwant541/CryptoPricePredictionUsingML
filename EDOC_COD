import os
import extract_msg

# Input folder containing .msg files
input_folder = r"C:\path\to\your\msg\files"
# Output folder to save the extracted txt files
output_folder = r"C:\path\to\save\txt\files"

# Create output folder if it doesn't exist
os.makedirs(output_folder, exist_ok=True)

# Loop through all .msg files in the input folder
for filename in os.listdir(input_folder):
    if filename.lower().endswith(".msg"):
        msg_path = os.path.join(input_folder, filename)
        msg = extract_msg.Message(msg_path)
        msg_body = msg.body  # Entire body of the email

        # Clean filename and replace extension with .txt
        base_name = os.path.splitext(filename)[0]
        txt_filename = f"{base_name}.txt"
        txt_path = os.path.join(output_folder, txt_filename)

        # Save email body as txt
        with open(txt_path, "w", encoding="utf-8") as f:
            f.write(msg_body)

        print(f"Saved: {txt_filename}")

print("All emails have been processed.")
