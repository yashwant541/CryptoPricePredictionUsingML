import os
import pandas as pd

def count_rows_in_file(file_path):
    if file_path.endswith('.csv'):
        df = pd.read_csv(file_path)
    elif file_path.endswith('.xlsx'):
        df = pd.read_excel(file_path)
    else:
        return None
    return len(df)

def scan_folders(base_path):
    data = []
    for folder_name in os.listdir(base_path):
        folder_path = os.path.join(base_path, folder_name)
        if os.path.isdir(folder_path):
            for file_name in os.listdir(folder_path):
                file_path = os.path.join(folder_path, file_name)
                if file_name.endswith('.csv') or file_name.endswith('.xlsx'):
                    row_count = count_rows_in_file(file_path)
                    if row_count is not None:
                        data.append([folder_path, folder_name, file_name, row_count])
    return data

def save_to_csv(data, output_file):
    df = pd.DataFrame(data, columns=['Folder Path', 'Folder Name', 'File Name with Extension', 'File Row Count'])
    df.to_csv(output_file, index=False)

# Usage example
base_path = 'your/folder/path/here'
output_file = 'output_file.csv'

data = scan_folders(base_path)
save_to_csv(data, output_file)

print(f"CSV file saved: {output_file}")
