# -*- coding: utf-8 -*-
import dataiku
import pandas as pd
import os

# ==== Step 1: Get folder handle ====
# Replace with your actual Dataiku folder ID
input_folder = dataiku.Folder("INPUT_FOLDER_ID")

# ==== Step 2: Get file list from the folder ====
file_list = input_folder.list_paths_in_partition()

# Assuming only one CSV file in the folder
csv_file_path = file_list[0]

# ==== Step 3: Read CSV from folder ====
with input_folder.get_download_stream(csv_file_path) as f:
    df = pd.read_csv(f, encoding="utf-8")

# ==== Step 4: Process Data ====
# Example processing: Make all column names uppercase
df.columns = [col.upper() for col in df.columns]

# ==== Step 5: Save final CSV to local path ====
output_path = "/path/to/save/final_output.csv"  # Change this to your desired path
df.to_csv(output_path, index=False, encoding="utf-8")

print(f"Processing complete. CSV saved at: {output_path}")
