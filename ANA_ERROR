def extract_date_from_filename(filename):
    """
    Extracts date in DD-MMM-YYYY format from filename and returns a datetime object.
    Handles extra spaces, multiple hyphens, or other characters.
    """
    # Remove extension
    name_only = filename.rsplit('.', 1)[0]

    # Search for date pattern: 1-2 digits, hyphen, 3-letter month, hyphen, 4-digit year
    match = re.search(r'(\d{1,2})[- ]([A-Za-z]{3})[- ](\d{4})', name_only)
    if match:
        day, month_str, year = match.groups()
        try:
            # Convert to datetime object
            date_obj = datetime.strptime(f"{day}-{month_str}-{year}", "%d-%b-%Y")
            return date_obj.strftime("%d-%b-%Y")  # Keep format as string
        except ValueError:
            return None
    return None
