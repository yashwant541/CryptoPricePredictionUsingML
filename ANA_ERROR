import pandas as pd
from dataiku import pandasutils as pdu

# Read the three datasets into DataFrames
dataset1 = dataiku.Dataset("dataset1_name").get_dataframe()
dataset2 = dataiku.Dataset("dataset2_name").get_dataframe()
dataset3 = dataiku.Dataset("dataset3_name").get_dataframe()

# Create an Excel writer object
output_file_path = dataiku.Folder("your_output_folder_id").get_path() + "/output_file.xlsx"

with pd.ExcelWriter(output_file_path, engine="openpyxl") as writer:
    # Save each dataset to a separate sheet, using their names as sheet names
    dataset1.to_excel(writer, sheet_name="dataset1_name", index=False)
    dataset2.to_excel(writer, sheet_name="dataset2_name", index=False)
    dataset3.to_excel(writer, sheet_name="dataset3_name", index=False)

print(f"Excel file saved at {output_file_path}")
