import pandas as pd

# Function to process the names and split them by semicolon
def split_names(df, column_name):
    # Remove trailing semicolons first, if any
    df[column_name] = df[column_name].str.rstrip(';')
    
    # Split the names on semicolon and explode the rows
    df[column_name] = df[column_name].str.split(';')
    
    # Use explode to split the rows based on the list of names
    df = df.explode(column_name).reset_index(drop=True)
    
    return df

# Function to read and process the Excel file
def process_excel(file_path, sheet_name, column_name):
    # Read the Excel file
    df = pd.read_excel(file_path, sheet_name=sheet_name)
    
    # Process the names column
    df = split_names(df, column_name)
    
    return df

# Specify the file path, sheet name, and the column with names
file_path = 'your_file.xlsx'
sheet_name = 'Sheet1'  # Replace with your actual sheet name
column_name = 'Names'  # Replace with your actual column name containing the names

# Process the file and get the updated DataFrame
updated_df = process_excel(file_path, sheet_name, column_name)

# Optionally, save the result to a new Excel file
output_file_path = 'processed_file.xlsx'
updated_df.to_excel(output_file_path, index=False)

print("Processed file saved to", output_file_path)
