import PyPDF2
from docx import Document
import pandas as pd
import sys

def extract_tables_from_pdf(pdf_path):
    """Extract tables from a PDF file"""
    tables = []
    with open(pdf_path, 'rb') as file:
        reader = PyPDF2.PdfReader(file)
        
        for page_num in range(len(reader.pages)):
            page = reader.pages[page_num]
            text = page.extract_text()
            
            # Simple table detection - looks for text with consistent spacing
            # This is a basic approach - for more robust extraction consider camelot or pdfplumber
            lines = text.split('\n')
            
            # Check if we have at least 2 lines with similar spacing (potential table)
            if len(lines) >= 2:
                # Simple heuristic: if multiple lines have the same number of 'spaces' in similar positions
                tables.append(f"Table found on page {page_num + 1}:\n" + "\n".join(lines[:10]) + "\n...")
    
    if not tables:
        return ["No tables detected in PDF (note: simple text extraction may miss complex tables)"]
    return tables

def extract_tables_from_docx(docx_path):
    """Extract tables from a Word document"""
    doc = Document(docx_path)
    tables = []
    
    for i, table in enumerate(doc.tables):
        table_data = []
        
        for row in table.rows:
            row_data = []
            for cell in row.cells:
                row_data.append(cell.text.strip())
            table_data.append(row_data)
        
        # Convert to pandas DataFrame for better display
        df = pd.DataFrame(table_data)
        tables.append(f"Table {i + 1}:\n{df.to_string(index=False, header=False)}\n")
    
    if not tables:
        return ["No tables found in Word document"]
    return tables

def main():
    print("Table Extraction Tool")
    print("---------------------\n")
    
    # Ask for file type
    file_type = input("Are your files Word documents (.docx) or PDFs (.pdf)? Enter 'docx' or 'pdf': ").lower().strip()
    while file_type not in ['docx', 'pdf']:
        print("Invalid input. Please enter 'docx' or 'pdf'.")
        file_type = input("Are your files Word documents (.docx) or PDFs (.pdf)? ").lower().strip()
    
    # Get file paths
    file1 = input("Enter path to first file: ").strip()
    file2 = input("Enter path to second file: ").strip()
    
    # Process files
    print("\nProcessing files...\n")
    
    for i, file_path in enumerate([file1, file2], 1):
        print(f"=== Results for File {i}: {file_path} ===")
        
        try:
            if file_type == 'docx':
                tables = extract_tables_from_docx(file_path)
            else:
                tables = extract_tables_from_pdf(file_path)
            
            for table in tables:
                print(table)
                print("-" * 50)
                
        except Exception as e:
            print(f"Error processing {file_path}: {str(e)}")
        
        print("\n")

if __name__ == "__main__":
    main()
