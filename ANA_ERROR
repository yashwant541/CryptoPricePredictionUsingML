from reportlab.lib.pagesizes import letter
from reportlab.lib import colors
from reportlab.pdfgen import canvas
from PIL import Image
import os

# Define function to add custom text and images to pages
def add_page(c, page_number, image_folder):
    # Page 1: Title
    if page_number == 1:
        c.setFont("Helvetica", 50)
        c.setFillColor(colors.black)
        c.drawCentredString(300, 750, "XYZ Report")
    else:
        # Custom text for page 2 to 5
        c.setFont("Helvetica", 18)
        custom_text = f"This is custom text for page {page_number}"
        c.drawString(50, 750, custom_text)
        
        # Add image (PNG)
        image_path = os.path.join(image_folder, f"image{page_number - 1}.png")
        if os.path.exists(image_path):
            img = Image.open(image_path)
            img_width, img_height = img.size
            aspect_ratio = img_height / float(img_width)
            c.drawImage(image_path, 50, 500, width=500, height=500 * aspect_ratio)

# Create the PDF
def create_pdf(output_path, image_folder):
    c = canvas.Canvas(output_path, pagesize=letter)
    
    # Loop through 5 pages
    for page_number in range(1, 6):
        add_page(c, page_number, image_folder)
        c.showPage()  # Create a new page

    # Save the PDF
    c.save()

# Define your folder containing images
image_folder = "/path/to/your/images"  # Replace with the path to your PNG images

# Define the output path for the PDF file
output_pdf = "/path/to/output/report.pdf"  # Replace with your desired PDF file path

# Create the PDF report
create_pdf(output_pdf, image_folder)

print("PDF report created successfully!")
