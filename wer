def save_final_processed_files(user_parameters: dict, df_clean: pd.DataFrame, df_excluded: pd.DataFrame, same_keywords_summary: pd.DataFrame):
    # Check if 'Output_Path' and 'File_name' keys are present
    output_path = user_parameters.get('Output_Path', '.')
    file_name = user_parameters.get('File_name', 'default_filename')  # Provide a default filename if 'File_name' is not present
    
    # Combine the 'Same_keywords' and 'Same_keywords_list' columns
    same_keywords_summary['Same_keywords_list'] = same_keywords_summary.index
    
    # Save the final processed files
    with pd.ExcelWriter(os.path.join(output_path, f"Processed_{file_name}.xlsx"), engine='xlsxwriter') as writer:
        df_clean.to_excel(writer, sheet_name='Cleaned_Data', index=False)
        df_excluded.to_excel(writer, sheet_name='Excluded_Data', index=False)
        same_keywords_summary.reset_index().to_excel(writer, sheet_name='Same_Keywords_Summary', index=False)
